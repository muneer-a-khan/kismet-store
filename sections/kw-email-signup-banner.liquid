{%- comment -%}
KW Email Signup Banner — matches footer look
• Places a newsletter box you can drag just above the footer
• Keeps input styling from theme; only forces the submit button to white w/ black arrow
• Uses Shopify's native 'customer' form for newsletter signups
{%- endcomment -%}

<section id="kw-email-{{ section.id }}" class="kw-email-banner">
  <div class="page-width">
    <div class="kw-email-inner">
      {%- if section.settings.heading != blank -%}
        <h2 class="kw-email-heading">{{ section.settings.heading }}</h2>
      {%- endif -%}
      {%- if section.settings.subheading != blank -%}
        <p class="kw-email-sub">{{ section.settings.subheading }}</p>
      {%- endif -%}

      {%- form 'customer', id: 'KWNewsletterForm-' | append: section.id, class: 'newsletter-form', novalidate: 'novalidate' -%}
        <input type="hidden" name="contact[tags]" value="newsletter">

        <div class="newsletter-form__field-wrapper">
          <div class="field">
            <input
              id="NewsletterForm--{{ section.id }}"
              type="email"
              name="contact[email]"
              class="field__input"
              value="{{ form.email }}"
              aria-label="{{ 'newsletter.label' | t | default: 'Email' }}"
              autocorrect="off"
              autocapitalize="off"
              autocomplete="email"
              placeholder="{{ section.settings.placeholder | default: 'Your email address' }}"
              required
            >
            <label class="field__label" for="NewsletterForm--{{ section.id }}">{{ section.settings.placeholder | default: 'Your email address' }}</label>
          </div>

          <button type="submit" class="newsletter-form__button" aria-label="{{ section.settings.button_label | default: 'Subscribe' }}">
            <span class="visually-hidden">{{ section.settings.button_label | default: 'Subscribe' }}</span>
            {%- comment -%} Arrow icon inherits currentColor {%- endcomment -%}
            <svg class="icon" width="22" height="22" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
              <path d="M5 12h12m0 0-5-5m5 5-5 5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
          </button>
        </div>

        {%- if form.errors -%}
          <small class="newsletter-form__message" role="alert">{{ form.errors | default_errors }}</small>
        {%- elsif form.posted_successfully? -%}
          <small class="newsletter-form__message" role="status">{{ section.settings.success | default: 'Thanks for subscribing!' }}</small>
        {%- endif -%}
      {%- endform -%}
    </div>
  </div>

  <style>
    /* ===== Scoped to this section only ===== */
    #kw-email-{{ section.id }}{
      padding: {{ section.settings.padding_y | default: 28 }}px 0;
    }
    #kw-email-{{ section.id }} .kw-email-inner{
      display:grid; gap:10px 24px; align-items:center;
    }
    #kw-email-{{ section.id }} .kw-email-heading{
      margin:0; font-weight:800; letter-spacing:.02em;
      font-size: clamp(1.05rem, 1rem + .6vw, 1.35rem);
    }
    #kw-email-{{ section.id }} .kw-email-sub{
      margin:0 0 .25rem 0; opacity:.8;
    }

    /* Let the form sit on one line on desktop, stack on mobile */
    @media (min-width: 750px){
      #kw-email-{{ section.id }} .kw-email-inner{
        grid-template-columns: 1fr auto; /* text on left, form on right */
      }
    }

    /* Keep INPUT styling from theme (field__input), do not alter outline/box */

    /* Force the SUBMIT button to white box + WHITE arrow (updated from black) */
    #kw-email-{{ section.id }} .newsletter-form__button{
      background:#ffffff !important; color:#ffffff !important; border-color:#ffffff !important;
    }
    #kw-email-{{ section.id }} .newsletter-form__button:hover,
    #kw-email-{{ section.id }} .newsletter-form__button:focus,
    #kw-email-{{ section.id }} .newsletter-form__button:active{
      background:#ffffff !important; color:#ffffff !important; border-color:#ffffff !important;
    }
    /* Ensure arrow uses button color across theme variants */
    #kw-email-{{ section.id }} .newsletter-form__button .icon,
    #kw-email-{{ section.id }} .newsletter-form__button svg,
    #kw-email-{{ section.id }} .newsletter-form__button svg path{
      fill: currentColor !important; stroke: currentColor !important;
    }

    /* Tidy field alignment with Dawn’s classes */
    #kw-email-{{ section.id }} .newsletter-form__field-wrapper{
      display:flex; align-items:stretch; gap:.5rem;
    }
    #kw-email-{{ section.id }} .field{ flex:1 1 auto; }
  </style>
</section>

{% schema %}
{
  "name": "KW Email Signup Banner",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Subscribe to our emails" },
    { "type": "text", "id": "subheading", "label": "Subheading", "default": "Be the first to know about new collections and exclusive offers." },
    { "type": "text", "id": "placeholder", "label": "Email placeholder", "default": "Your email address" },
    { "type": "text", "id": "button_label", "label": "Button label (for accessibility)", "default": "Subscribe" },
    { "type": "text", "id": "success", "label": "Success message", "default": "Thanks for subscribing!" },
    { "type": "range", "id": "padding_y", "label": "Vertical padding", "min": 0, "max": 80, "step": 2, "default": 28 }
  ],
  "presets": [
    { "name": "KW Email Signup Banner" }
  ]
}
{% endschema %}
